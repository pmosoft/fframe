<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.pmosoft.fframe.dams.code.CodeDao">

<select id="selectCodeList" parameterType="java.util.HashMap" resultType="java.util.LinkedHashMap">

    -- TermDao.selectCodeList
    SELECT   A.CD_ID_NM    
            ,A.CD_ID_HNM   
            ,A.CD_ID_GRP_NM
            ,A.CD          
            ,A.CD_NM       
            ,A.CD_HNM      
            ,A.CD_DESC      
            ,A.CD_STS_CD   
            ,B.CD_HNM AS CD_STS_CD_NM   
            ,date_format(A.REG_DTM,'%Y.%m.%d %H:%i:%S') AS REG_DTM
            ,A.REG_USR_ID
            ,date_format(A.UPD_DTM,'%Y.%m.%d %H:%i:%S') AS UPD_DTM
            ,A.UPD_USR_ID
    FROM    TDACM00060 A
            LEFT JOIN TDACM00060 B
            ON  B.CD_ID_NM = 'CD_STS_CD'
            AND B.CD = A.CD_STS_CD
    WHERE   A.CD_ID_HNM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_NM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_HNM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_ID_GRP_NM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    ORDER BY A.CD_ID_NM, A.CD
</select>


<select id="selectCodeRegList" parameterType="java.util.HashMap" resultType="java.util.LinkedHashMap">

    -- TermDao.selectCodeRegList
    SELECT   A.CD_ID_NM    
            ,A.CD_ID_HNM   
            ,A.CD_ID_GRP_NM
            ,A.CD          
            ,A.CD_NM       
            ,A.CD_HNM      
            ,A.CD_DESC      
            ,A.CD_STS_CD   
            ,date_format(A.REG_DTM,'%Y.%m.%d %H:%i:%S') AS REG_DTM
            ,A.REG_USR_ID
            ,date_format(A.UPD_DTM,'%Y.%m.%d %H:%i:%S') AS UPD_DTM
            ,A.UPD_USR_ID
    FROM    TDACM00060 A
    WHERE   A.CD_ID_HNM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_NM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_HNM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    OR      A.CD_ID_GRP_NM LIKE CONCAT(CONCAT('%',#{searchValue}),'%')
    ORDER BY A.CD_ID_NM, A.CD
</select>


<insert id="insertCode" parameterType="java.util.HashMap">

	-- TermDao.insertCode
	INSERT INTO TDACM00010
	(
	     PKG_FUL_NM
		,PKG2_NM
		,PKG3_NM
		,PKG4_NM
		,PKG_HNM
		,PKG_DESC
		,USE_YN
		,REG_DTM
		,REG_USR_ID
		,UPD_DTM
		,UPD_USR_ID
	) VALUES (
         #{PKG_FUL_NM}
		,#{PKG2_NM}
		,#{PKG3_NM}
		,#{PKG4_NM}
		,#{PKG_HNM}
		,#{PKG_DESC}
		,CASE WHEN #{USE_YN} = 'true' THEN 'Y' ELSE 'N' END
		,curdate()
		,#{REG_USR_ID}
		,curdate()
		,#{UPD_USR_ID}
	)

</insert>


<delete id="deleteCode" parameterType="java.util.HashMap">
	-- TermDao.deleteCode
	DELETE FROM TDACM00010 WHERE PKG_FUL_NM = #{PKG_FUL_NM}
</delete>

<update id="updateCode" parameterType="java.util.HashMap">

	-- TermDao.updateCode
	UPDATE TDACM00010
	SET  PKG2_NM      = #{PKG2_NM}
		,PKG3_NM      = #{PKG3_NM}
		,PKG4_NM      = #{PKG4_NM}
		,PKG_HNM      = #{PKG_HNM}
		,PKG_DESC     = #{PKG_DESC}
		,USE_YN       = CASE WHEN #{USE_YN} = 'true' THEN 'Y' ELSE 'N' END
		,UPD_DTM      = curdate()
		,UPD_USR_ID  = #{UPD_USR_ID}
	WHERE  PKG_FUL_NM = #{PKG_FUL_NM}

</update>


</mapper>
